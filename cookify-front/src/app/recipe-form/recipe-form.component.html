<div class="container">


<mat-dialog-content>
  <div class="actions">
    <mat-dialog-actions>
      <button mat-icon-button color="warn" mat-dialog-close aria-label="Close">
        <mat-icon>close</mat-icon>
      </button>
    </mat-dialog-actions>
  </div>

  <h2 mat-dialog-title>New recipe</h2>

    <form [formGroup]="newRecipeForm" (ngSubmit)="onSubmit()">
      <div class="form-fields">
      <div>
        <mat-form-field appearance="fill">
          <mat-label>Name</mat-label>
          <input matInput formControlName="name" required />
          <mat-error *ngIf="newRecipeForm.controls['name'].hasError('required')">
            Le nom de la recette est requis.
          </mat-error>
        </mat-form-field>
      </div>

      <div>
        <mat-form-field appearance="fill">
          <mat-label>Temps de cuisson</mat-label>
          <input matInput formControlName="cookingTime" required/>
          <mat-error *ngIf="newRecipeForm.controls['cookingTime'].hasError('required')">
            Le temps de cuisson est requis.
          </mat-error>
          <mat-error *ngIf="newRecipeForm.controls['cookingTime'].hasError('pattern')">
            Veuillez entrer un nombre valide.
          </mat-error>
        </mat-form-field>
      </div>

      <div>
        <mat-form-field appearance="fill">
          <mat-label>Description</mat-label>
          <textarea matInput formControlName="description"></textarea>
        </mat-form-field>
      </div>

      <div>
        <mat-form-field appearance="fill">
          <mat-label>Calories</mat-label>
          <input matInput formControlName="calories" required />
          <mat-error *ngIf="newRecipeForm.controls['calories'].hasError('required')">
            Le nombre de calories est requis.
          </mat-error>
          <mat-error *ngIf="newRecipeForm.controls['calories'].hasError('pattern')">
            Veuillez entrer un nombre valide.
          </mat-error>
        </mat-form-field>
      </div>

      <div>
        <mat-form-field appearance="fill">
          <mat-label>Quantité</mat-label>
          <input matInput type="number" formControlName="quantity" required />
          <mat-error *ngIf="newRecipeForm.controls['quantity'].hasError('required')">
            La quantité est requise.
          </mat-error>
          <mat-error *ngIf="newRecipeForm.controls['quantity'].hasError('pattern')">
            Veuillez entrer un nombre valide.
          </mat-error>
        </mat-form-field>
      </div>

      <div>
        <mat-form-field appearance="fill">
          <mat-label>Temps de préparatiion</mat-label>
          <input matInput formControlName="preparationTime" required />
          <mat-error *ngIf="newRecipeForm.controls['preparationTime'].hasError('required')">
            Le temps de préparation est requis.
          </mat-error>
          <mat-error *ngIf="newRecipeForm.controls['preparationTime'].hasError('pattern')">
            Veuillez entrer un nombre valide.
          </mat-error>
        </mat-form-field>
      </div>

      <div>
        <mat-form-field appearance="fill">
          <mat-label>Instructions</mat-label>
          <textarea matInput formControlName="instructions" required></textarea>
          <mat-error *ngIf="newRecipeForm.controls['instructions'].hasError('required')">
            Les instructions sont requises.
          </mat-error>
        </mat-form-field>
      </div>

      <div>
        <mat-form-field appearance="fill">
          <mat-label>Difficulté</mat-label>
          <input matInput formControlName="difficulty" required />
          <mat-error *ngIf="newRecipeForm.controls['difficulty'].hasError('required')">
            La difficulté est requise.
          </mat-error>
        </mat-form-field>
      </div>

      <div>
        <mat-form-field appearance="fill">
          <mat-label>Image </mat-label>
          <br>
          <mat-icon>folder</mat-icon>
          <ngx-mat-file-input multiple="false" (change)="onFileSelected($event)" accept="image/*" formControlName="image" required>
          </ngx-mat-file-input>
          <mat-error *ngIf="newRecipeForm.controls['image'].hasError('required')">
            Une image est requise.
          </mat-error>
        </mat-form-field>
        <img *ngIf="imagePreview" [src]="imagePreview" alt="Aperçu de l'image" width="100">
      </div>

      <mat-slide-toggle formControlName="isPublic">Est public</mat-slide-toggle>

      <div *ngIf="errorMessage" class="error-message">
        {{ errorMessage }}
      </div>

      </div>
      <div>
        <button mat-raised-button color="success" type="submit" [disabled]="newRecipeForm.invalid">Créer</button>
      </div>
    </form>
</mat-dialog-content>
</div>
<div *ngIf="isLoading" class="loading">
  <mat-spinner></mat-spinner>
</div>
